% === INPUT DATA ===
global Pload Pload2 PRe_avai PRe_avai2 Soc_start soc
global Pg1_max Pg2_max Pg3_max Pg4_max Pg5_max
global eta_ch eta_dis
global PVAvai WindAvai
global PVAvai2 WindAvai2
global total_fuel_max

oil_max_gen1 = max_oil_usage(560);
oil_max_gen2 = max_oil_usage(630);
oil_max_gen3 = max_oil_usage(410);
oil_max_gen4 = max_oil_usage(1000);
oil_max_gen5 = max_oil_usage(1000);

total_fuel_max = oil_max_gen1 + oil_max_gen2 + oil_max_gen3 + oil_max_gen4 + oil_max_gen5;
%%
% Kịch bản ngày nhiều Re
% Phụ tải theo giờ (kW)
Pload = [209.145897, 202.092172, 191.892128, 190.112839, 199.870618, 210.302199, 215.088744, 217.585824,...
         230.320462, 245.742942, 250.379947, 233.233375, 226.272191, 221.379410, 226.402145, 233.015409,...
         255.704721, 299.521682, 315.072858, 290.642823, 280.089324, 280.603301, 270.731804, 253.868677]';

% Công suất khả dụng từ PV và gió (kW)
PVAvai = [0, 0, 0, 0, 0, 0, 0, 11.246999, 26.969547, 30.553504,...
          60.197833, 37.442088, 27.553459, 21.074532, 18.885042,...
          15.689424, 14.635436, 13.393112, 0, 0, 0, 0, 0, 0]';

WindAvai = [386.337105, 385.861497, 383.705083, 386.961671, 385.930126, 387.466780, 385.385586, 385.467371,...
            386.415001, 387.257877, 387.865787, 384.544665, 384.698724, 384.212587, 385.459849, 387.047390,...
            387.365560, 386.337105, 391.257349, 393.631201, 391.554079, 390.972733, 391.257349, 386.396249]';
%%
% Kich ban ngay it Re
Pload2 = [247.297360, 242.049367, 241.948467, 235.073200, 237.636436, 226.793882,...
         230.487984, 227.840731, 237.135703, 243.162474, 266.244930, 259.378386,...
         258.111488, 255.214571, 253.331899, 262.886439, 259.087032, 269.284784,...
         268.038869, 270.716046, 259.159985, 260.716872, 248.414850, 248.107266]';

PVAvai2 = [0, 0, 0, 0, 0, 0, 17.426389, 86.585035, 145.271574, 104.526158, 174.655671,...
            216.738669, 191.712680, 145.495297, 130.540043, 114.141069, 56.982905, 10.464987, ...
                0, 0, 0, 0, 0, 0]';

WindAvai2 = [14.870174, 1.390727, 1.390727, 0.231413, 1.054179, 1.764946, 0.141487, 1.380252, ...
                1.543255, 1.256031, 1.568704, 1.227477, 34.835953, 3.140926, 0.705006, 0.640070, ...
                    1.295806, 1.782503, 2.594711, 1.464675, 38.362745, 40.269401, 1.774905, 2.438830]';

%%


% Tổng công suất RE khả dụng
PRe_avai = PVAvai + WindAvai;
PRe_avai2 = PVAvai2 + WindAvai2;


% SOC đầu ngày
Soc_max = 1;         % 100%
Soc_min = 0;         % 0%
Soc_start = 0.1;     % giả định
change_diff = 120;   %ràng buộc sự thay đổi máy phát

% Giới hạn công suất máy phát
Pg1_max = 560 * ones(24,1);
Pg2_max = 630 * ones(24,1);
Pg3_max = 410 * ones(24,1);
Pg4_max = 1000 * ones(24,1);
Pg5_max = 1000 * ones(24,1);  % Đặt lớn để không ràng buộc nếu chưa cần
x0 = zeros(168 + 24, 1);  % Tổng: 216 biến
Pbess_max = 500;
eff = 0.99;
eta_ch = 0.99;      % hiệu suất sạc
eta_dis = 0.99;     % hiệu suất xả
